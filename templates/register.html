{% extends "base.html" %}

{% block title %}Register - DBIT Alumni Hub{% endblock %}

{% block content %}
<link
    href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">

<div class="position-relative overflow-hidden min-vh-100 d-flex justify-content-center py-5"
    style="padding-top: 100px !important;">

    <!-- Animated Mesh Background -->
    <div class="mesh-background">
        <div class="mesh-ball ball-1"></div>
        <div class="mesh-ball ball-2"></div>
        <div class="mesh-ball ball-3"></div>
        <div class="mesh-ball ball-4"></div>
    </div>

    <!-- Container -->
    <div class="container position-relative z-2">
        <div class="row justify-content-center">
            <div class="col-xl-11 col-lg-12">

                <!-- Glassmorphic Card -->
                <div class="card-modern glass-panel reveal-fade shadow-2xl"
                    style="border-radius: 30px; overflow: hidden; height: 85vh; min-height: 700px; border: 1px solid rgba(255,255,255,0.4);">
                    <div class="row g-0 h-100">

                        <!-- LEFT SIDE: Branding (Sticky) -->
                        <div class="col-lg-4 d-none d-lg-flex flex-column position-relative overflow-hidden text-dark"
                            style="background: linear-gradient(135deg, #f0fdf4 0%, #ecfeff 100%);">

                            <!-- Animated Background Elements -->
                            <div class="position-absolute top-0 start-0 w-100 h-100 overflow-hidden">
                                <div class="blob-1 position-absolute rounded-circle filter-blur"
                                    style="width: 300px; height: 300px; background: #86efac; opacity: 0.3; top: -100px; left: -100px; filter: blur(60px); animation: float 10s infinite ease-in-out;">
                                </div>
                                <div class="blob-2 position-absolute rounded-circle filter-blur"
                                    style="width: 250px; height: 250px; background: #bae6fd; opacity: 0.3; bottom: -50px; right: -50px; filter: blur(50px); animation: float 12s infinite ease-in-out reverse;">
                                </div>
                            </div>

                            <div class="p-4 d-flex flex-column h-100 position-relative z-1">
                                <!-- Logo AREA -->
                                <div class="mb-4">
                                    <div
                                        class="d-inline-flex align-items-center gap-2 bg-white bg-opacity-50 px-3 py-2 rounded-pill backdrop-blur-sm border border-secondary border-opacity-10 shadow-sm">
                                        <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center"
                                            style="width: 24px; height: 24px;">
                                            <i class="fas fa-graduation-cap text-white" style="font-size: 12px;"></i>
                                        </div>
                                        <span class="small fw-bold tracking-wide text-uppercase text-dark">DBIT Alumni
                                            Hub</span>
                                    </div>
                                </div>

                                <!-- Main Content with Carousel -->
                                <div class="my-auto py-3">
                                    <h1 class="display-6 fw-bold mb-4 leading-tight text-dark">Your gateway to
                                        a<br><span id="typing-text" class="text-gradient-primary fs-4"
                                            style="background: linear-gradient(to right, #0ea5e9, #10b981); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Global
                                            Network</span><span class="cursor-blink text-primary">|</span></h1>

                                    <!-- Testimonial/Benefit Carousel -->
                                    <div id="brandingCarousel" class="carousel slide carousel-fade"
                                        data-bs-ride="carousel" data-bs-interval="4000">
                                        <div class="carousel-inner">
                                            <!-- Slide 1 -->
                                            <div class="carousel-item active">
                                                <div class="glass-card p-4 rounded-3 border border-secondary border-opacity-10 bg-white bg-opacity-60 shadow-sm"
                                                    data-tilt data-tilt-max="10" data-tilt-speed="400" data-tilt-glare
                                                    data-tilt-max-glare="0.2">
                                                    <i class="fas fa-users mb-3 text-info fs-4"></i>
                                                    <h5 class="fw-bold mb-2 text-dark">Build Connections</h5>
                                                    <p class="text-muted small mb-0">Reconnect with batchmates and
                                                        expand your professional network across industries.</p>
                                                </div>
                                            </div>
                                            <!-- Slide 2 -->
                                            <div class="carousel-item">
                                                <div class="glass-card p-4 rounded-3 border border-secondary border-opacity-10 bg-white bg-opacity-60 shadow-sm"
                                                    data-tilt data-tilt-max="10" data-tilt-speed="400" data-tilt-glare
                                                    data-tilt-max-glare="0.2">
                                                    <i class="fas fa-briefcase mb-3 text-warning fs-4"></i>
                                                    <h5 class="fw-bold mb-2 text-dark">Career Growth</h5>
                                                    <p class="text-muted small mb-0">Discover job opportunities,
                                                        mentorship programs, and exclusive career events.</p>
                                                </div>
                                            </div>
                                            <!-- Slide 3 -->
                                            <div class="carousel-item">
                                                <div class="glass-card p-4 rounded-3 border border-secondary border-opacity-10 bg-white bg-opacity-60 shadow-sm"
                                                    data-tilt data-tilt-max="10" data-tilt-speed="400" data-tilt-glare
                                                    data-tilt-max-glare="0.2">
                                                    <i class="fas fa-university mb-3 text-success fs-4"></i>
                                                    <h5 class="fw-bold mb-2 text-dark">Give Back</h5>
                                                    <p class="text-muted small mb-0">Share your expertise, mentor
                                                        students, and contribute to your alma mater's legacy.</p>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Indicators -->
                                        <div
                                            class="carousel-indicators position-static justify-content-start mt-4 px-0 mx-0">
                                            <button type="button" data-bs-target="#brandingCarousel"
                                                data-bs-slide-to="0" class="active rounded-circle bg-secondary"
                                                style="width: 8px; height: 8px;"></button>
                                            <button type="button" data-bs-target="#brandingCarousel"
                                                data-bs-slide-to="1" class="rounded-circle bg-secondary"
                                                style="width: 8px; height: 8px;"></button>
                                            <button type="button" data-bs-target="#brandingCarousel"
                                                data-bs-slide-to="2" class="rounded-circle bg-secondary"
                                                style="width: 8px; height: 8px;"></button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Footer / Stats -->
                                <div class="mt-4 pt-3 border-top border-secondary border-opacity-10">
                                    <div class="row g-3">
                                        <div class="col-6">
                                            <h4 class="fw-bold mb-0 text-dark"><span class="counter"
                                                    data-target="5000">0</span>+</h4>
                                            <span class="text-muted small">Alumni Connected</span>
                                        </div>
                                        <div class="col-6">
                                            <h4 class="fw-bold mb-0 text-dark"><span class="counter"
                                                    data-target="100">0</span>+</h4>
                                            <span class="text-muted small">Partner Companies</span>
                                        </div>
                                    </div>
                                    <div class="mt-4">
                                        <a href="/"
                                            class="text-muted text-decoration-none hover-dark small transition-all">
                                            <i class="fas fa-arrow-left me-2"></i> Back to Home
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- RIGHT SIDE: Scrollable Form -->
                        <div class="col-lg-8 h-100 bg-white position-relative">

                            <!-- Mobile Branding Header (Visible < lg) -->
                            <div class="d-lg-none text-center pt-4 pb-2 position-relative z-3">
                                <div
                                    class="d-inline-flex align-items-center gap-2 bg-light px-3 py-2 rounded-pill border shadow-sm">
                                    <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center"
                                        style="width: 24px; height: 24px;">
                                        <i class="fas fa-graduation-cap text-white" style="font-size: 12px;"></i>
                                    </div>
                                    <span class="small fw-bold tracking-wide text-uppercase text-dark">DBIT Alumni
                                        Hub</span>
                                </div>
                            </div>

                            <!-- Progress Bar -->
                            <div class="progress-container position-absolute top-0 start-0 w-100 z-3"
                                style="height: 6px; background: #f1f5f9;">
                                <div id="form-progress" class="progress-bar-premium"
                                    style="width: 0%; height: 100%; background: linear-gradient(90deg, #6366f1, #ec4899); transition: width 0.3s ease;">
                                </div>
                            </div>

                            <div class="h-100 overflow-y-auto custom-scrollbar p-5">

                                <div class="d-flex justify-content-between align-items-end mb-5">
                                    <div>
                                        <h2 class="fw-bold text-dark mb-1 font-heading">Create Account</h2>
                                        <p class="text-muted mb-0">It only takes a minute.</p>
                                    </div>
                                    <span class="badge bg-light text-primary border rounded-pill px-3 py-2"
                                        id="completion-badge">0% Completed</span>
                                </div>

                                {% with messages = get_flashed_messages(with_categories=true) %}
                                {% if messages %}
                                {% for category, message in messages %}
                                <div class="alert alert-{{ category }} fade show mb-4 border-0 shadow-sm rounded-3"
                                    role="alert">
                                    <i class="fas fa-info-circle me-2"></i> {{ message }}
                                </div>
                                {% endfor %}
                                {% endif %}
                                {% endwith %}

                                <form method="POST" id="registerForm" class="needs-validation"
                                    onsubmit="return validateRegisterForm()">

                                    <!-- Role Selection -->
                                    <div class="mb-5 section-fade">
                                        <label
                                            class="form-label fw-bold small text-uppercase text-muted tracking-wide mb-3">I
                                            am a...</label>
                                        <div class="row g-3">
                                            <div class="col-md-4">
                                                <input type="radio" class="btn-check" name="role" id="roleStudent"
                                                    value="student" {% if role=='student' or not role %}checked{% endif
                                                    %} onchange="updateFormFields()">
                                                <label
                                                    class="card-role w-100 p-4 text-center cursor-pointer rounded-4 border"
                                                    for="roleStudent">
                                                    <i class="fas fa-graduation-cap fa-2x mb-3 text-primary"></i>
                                                    <div class="fw-bold">Student</div>
                                                </label>
                                            </div>
                                            <div class="col-md-4">
                                                <input type="radio" class="btn-check" name="role" id="roleAlumni"
                                                    value="alumni" {% if role=='alumni' %}checked{% endif %}
                                                    onchange="updateFormFields()">
                                                <label
                                                    class="card-role w-100 p-4 text-center cursor-pointer rounded-4 border"
                                                    for="roleAlumni">
                                                    <i class="fas fa-user-tie fa-2x mb-3 text-success"></i>
                                                    <div class="fw-bold">Alumni</div>
                                                </label>
                                            </div>
                                            <div class="col-md-4">
                                                <input type="radio" class="btn-check" name="role" id="roleFaculty"
                                                    value="faculty" {% if role=='faculty' %}checked{% endif %}
                                                    onchange="updateFormFields()">
                                                <label
                                                    class="card-role w-100 p-4 text-center cursor-pointer rounded-4 border"
                                                    for="roleFaculty">
                                                    <i class="fas fa-chalkboard-teacher fa-2x mb-3 text-warning"></i>
                                                    <div class="fw-bold">Faculty</div>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Basic Info -->
                                    <div class="mb-5">
                                        <h5 class="fw-bold text-dark mb-4 pb-2 border-bottom">Basic Information</h5>
                                        <div class="row g-4">
                                            <div class="col-md-6">
                                                <label class="form-label fw-bold small text-muted">Full Name</label>
                                                <input type="text"
                                                    class="form-control form-control-lg bg-light border-0" id="name"
                                                    name="name" required placeholder="John Doe"
                                                    value="{{ form_data.get('name', '') if form_data else '' }}">
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label fw-bold small text-muted">Email Address</label>
                                                <input type="email"
                                                    class="form-control form-control-lg bg-light border-0" id="email"
                                                    name="email" required placeholder="john@example.com"
                                                    value="{{ form_data.get('email', '') if form_data else '' }}">
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label fw-bold small text-muted">Phone Number</label>
                                                <input type="tel" class="form-control form-control-lg bg-light border-0"
                                                    id="phone" name="phone" required placeholder="+91 9876543210"
                                                    value="{{ form_data.get('phone', '') if form_data else '' }}">
                                            </div>
                                            <div class="col-md-6">
                                                <!-- Empty column for alignment -->
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label fw-bold small text-muted">Password</label>
                                                <input type="password"
                                                    class="form-control form-control-lg bg-light border-0" id="password"
                                                    name="password" required placeholder="••••••••">
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label fw-bold small text-muted">Confirm
                                                    Password</label>
                                                <input type="password"
                                                    class="form-control form-control-lg bg-light border-0"
                                                    id="confirm_password" name="confirm_password" required
                                                    placeholder="••••••••">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Dynamic Fields (Hidden by default) -->
                                    <div id="studentFields" class="mb-5 animate-slide-down">
                                        <h5 class="fw-bold text-primary mb-4 pb-2 border-bottom">Student Details</h5>
                                        <div class="row g-4">
                                            <div class="col-md-6"><label
                                                    class="form-label small fw-bold text-muted">Enrollment
                                                    No</label><input type="text" class="form-control bg-light border-0"
                                                    id="enrollment_no" name="enrollment_no"
                                                    value="{{ form_data.get('enrollment_no', '') if form_data else '' }}">
                                            </div>

                                            <div class="col-md-6">
                                                <label class="form-label small fw-bold text-muted">Category</label>
                                                <select class="form-select bg-light border-0" id="category"
                                                    name="category" onchange="updateCourseDropdown()">
                                                    <option value="">Select Category</option>
                                                    <option value="IT">IT / Technology</option>
                                                    <option value="Engineering">Engineering</option>
                                                    <!-- Add other options as needed in JS or static -->
                                                    <option value="Science">Science</option>
                                                    <option value="Commerce">Commerce</option>
                                                    <option value="Arts">Arts</option>
                                                    <option value="Medical">Medical</option>
                                                    <option value="Law">Law</option>
                                                </select>
                                            </div>

                                            <div class="col-md-6">
                                                <label class="form-label small fw-bold text-muted">Level</label>
                                                <select class="form-select bg-light border-0" id="level" name="level"
                                                    onchange="updateCourseDropdown()">
                                                    <option value="">Select Level</option>
                                                    <option value="UG">Undergraduate</option>
                                                    <option value="PG">Postgraduate</option>
                                                    <option value="Diploma">Diploma</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label small fw-bold text-muted">Course</label>
                                                <select class="form-select bg-light border-0" id="degree" name="degree">
                                                    <option value="">Select Course</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label small fw-bold text-muted">Department</label>
                                                <select class="form-select bg-light border-0" id="department"
                                                    name="department">
                                                    <option value="">Select Department</option>
                                                    <option value="Information Technology">IT</option>
                                                    <option value="Computer Science">CS</option>
                                                    <option value="Computer Engineering">Computer Engg</option>
                                                    <option value="Electronics & Communication">EXTC</option>
                                                    <option value="Mechanical Engineering">Mechanical</option>
                                                    <option value="Civil Engineering">Civil</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label small fw-bold text-muted">Semester</label>
                                                <select class="form-select bg-light border-0" id="semester"
                                                    name="semester">
                                                    <option value="">Select Semester</option>
                                                    <option value="1">1</option>
                                                    <option value="2">2</option>
                                                    <option value="3">3</option>
                                                    <option value="4">4</option>
                                                    <option value="5">5</option>
                                                    <option value="6">6</option>
                                                    <option value="7">7</option>
                                                    <option value="8">8</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="alumniFields" style="display: none;" class="mb-5 animate-slide-down">
                                        <h5 class="fw-bold text-success mb-4 pb-2 border-bottom">Alumni Details</h5>
                                        <div class="row g-4">
                                            <div class="col-md-6"><label
                                                    class="form-label small fw-bold text-muted">Enrollment
                                                    No</label><input type="text" class="form-control bg-light border-0"
                                                    id="alum_enrollment_no" name="enrollment_no"
                                                    value="{{ form_data.get('enrollment_no', '') if form_data else '' }}">
                                            </div>

                                            <!-- Alumni Education Fields (Mirrors Student) -->
                                            <div class="col-md-6">
                                                <label class="form-label small fw-bold text-muted">Category</label>
                                                <select class="form-select bg-light border-0" id="alum_category"
                                                    name="category" onchange="updateAlumniCourseDropdown()">
                                                    <option value="">Select Category</option>
                                                    <option value="IT">IT / Technology</option>
                                                    <option value="Engineering">Engineering</option>
                                                    <option value="Science">Science</option>
                                                    <option value="Commerce">Commerce</option>
                                                    <option value="Arts">Arts</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label small fw-bold text-muted">Level</label>
                                                <select class="form-select bg-light border-0" id="alum_level"
                                                    name="level" onchange="updateAlumniCourseDropdown()">
                                                    <option value="">Select Level</option>
                                                    <option value="UG">Undergraduate</option>
                                                    <option value="PG">Postgraduate</option>
                                                    <option value="Diploma">Diploma</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label small fw-bold text-muted">Course</label>
                                                <select class="form-select bg-light border-0" id="alum_degree"
                                                    name="degree">
                                                    <option value="">Select Course</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label small fw-bold text-muted">Department</label>
                                                <select class="form-select bg-light border-0" id="alum_department"
                                                    name="department">
                                                    <option value="">Select Department</option>
                                                    <option value="Information Technology">IT</option>
                                                    <option value="Computer Science">CS</option>
                                                    <option value="Mechanical Engineering">Mechanical</option>
                                                    <option value="Civil Engineering">Civil</option>
                                                </select>
                                            </div>

                                            <div class="col-md-6"><label
                                                    class="form-label small fw-bold text-muted">Passing
                                                    Year</label>
                                                <select class="form-select bg-light border-0" id="pass_year"
                                                    name="pass_year">
                                                    {% for year in range(2024, 1999, -1) %}<option value="{{ year }}">{{
                                                        year }}</option>{% endfor %}
                                                </select>
                                            </div>
                                            <div class="col-md-6"><label
                                                    class="form-label small fw-bold text-muted">Current
                                                    Company</label><input type="text"
                                                    class="form-control bg-light border-0" id="company_name"
                                                    name="company_name"
                                                    value="{{ form_data.get('company_name', '') if form_data else '' }}">
                                            </div>
                                            <div class="col-md-6"><label
                                                    class="form-label small fw-bold text-muted">Designation</label><input
                                                    type="text" class="form-control bg-light border-0"
                                                    id="alum_designation" name="designation"></div>
                                        </div>
                                    </div>

                                    <div id="facultyFields" style="display: none;" class="mb-5 animate-slide-down">
                                        <h5 class="fw-bold text-warning mb-4 pb-2 border-bottom">Faculty Details</h5>
                                        <div class="row g-4">
                                            <div class="col-md-6"><label
                                                    class="form-label small fw-bold text-muted">Employee
                                                    ID</label><input type="text" class="form-control bg-light border-0"
                                                    id="fac_employee_id" name="employee_id"
                                                    value="{{ form_data.get('employee_id', '') if form_data else '' }}">
                                            </div>
                                            <div class="col-md-6"><label
                                                    class="form-label small fw-bold text-muted">Department</label>
                                                <select class="form-select bg-light border-0" id="fac_department"
                                                    name="department">
                                                    <option value="">Select Department</option>
                                                    <option value="Information Technology">IT</option>
                                                    <option value="Computer Science">CS</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6"><label
                                                    class="form-label small fw-bold text-muted">Designation</label>
                                                <select class="form-select bg-light border-0" id="fac_designation"
                                                    name="designation">
                                                    <option value="Professor">Professor</option>
                                                    <option value="Assistant Professor">Assistant Professor</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-4 form-check">
                                        <input type="checkbox" class="form-check-input" id="terms" required>
                                        <label class="form-check-label text-muted small" for="terms">I agree to the <a
                                                href="#" class="text-primary text-decoration-none">Terms &
                                                Conditions</a> and <a href="#"
                                                class="text-primary text-decoration-none">Privacy
                                                Policy</a>.</label>
                                    </div>

                                    <button type="submit"
                                        class="btn btn-primary btn-lg w-100 py-3 fw-bold shadow-lg hover-lift"
                                        style="border-radius: 12px; background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); border: none;">
                                        Create Account <i class="fas fa-arrow-right ms-2"></i>
                                    </button>

                                    <div class="text-center mt-4 text-muted">
                                        Already have an account? <a href="/login"
                                            class="fw-bold text-primary text-decoration-none">Login Here</a>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<style>
    .card-role {
        transition: all 0.3s ease;
        border-color: #e2e8f0;
    }

    .btn-check:checked+.card-role {
        border-color: #6366f1;
        background-color: #eff6ff;
        color: #4f46e5;
        box-shadow: 0 4px 6px -1px rgba(99, 102, 241, 0.1), 0 2px 4px -1px rgba(99, 102, 241, 0.06);
    }

    .form-control:focus,
    .form-select:focus {
        background-color: #fff !important;
        border: 1px solid #6366f1 !important;
        box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1) !important;
    }

    .animate-slide-down {
        animation: slideDown 0.4s ease-out;
    }

    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>

<style>
    /* Role Card Styles */
    .card-role {
        background: rgba(255, 255, 255, 0.5);
        border: 2px solid transparent;
        border-radius: 12px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .card-role:hover {
        background: rgba(255, 255, 255, 0.8);
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }

    .btn-check:checked+.card-role {
        background: rgba(99, 102, 241, 0.1);
        border-color: #6366f1;
        box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.1);
    }

    .role-icon {
        font-size: 1.5rem;
        color: #64748b;
        transition: all 0.3s ease;
    }

    .btn-check:checked+.card-role .role-icon {
        color: #6366f1;
        transform: scale(1.1);
    }

    .role-name {
        font-weight: 600;
        color: #1e293b;
    }

    .role-check {
        position: absolute;
        top: 8px;
        right: 8px;
        color: #6366f1;
        opacity: 0;
        font-size: 0.8rem;
        transform: scale(0);
        transition: all 0.3s ease;
    }

    .btn-check:checked+.card-role .role-check {
        opacity: 1;
        transform: scale(1);
    }

    /* Inner Glass Container */
    .glass-inner {
        background: rgba(255, 255, 255, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.6);
    }

    /* Custom Scrollbar for Form Area */
    .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
    }

    .custom-scrollbar::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.02);
    }

    .custom-scrollbar::-webkit-scrollbar-thumb {
        background: rgba(99, 102, 241, 0.2);
        border-radius: 10px;
    }

    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: rgba(99, 102, 241, 0.4);
    }

    /* Reveal Animation for Progress Bar */
    @keyframes progressGlow {
        0% {
            box-shadow: 0 0 5px rgba(99, 102, 241, 0.5);
        }

        50% {
            box-shadow: 0 0 15px rgba(236, 72, 153, 0.7);
        }

        100% {
            box-shadow: 0 0 5px rgba(99, 102, 241, 0.5);
        }
    }

    .progress-bar-premium {
        animation: progressGlow 2s infinite;
    }

    /* Floating Icons Animation */
    @keyframes floatIcon {

        0%,
        100% {
            transform: translateY(0);
        }

        50% {
            transform: translateY(-15px);
        }
    }

    .floating-icon {
        animation: floatIcon 4s ease-in-out infinite;
        pointer-events: none;
    }

    .icon-1 {
        animation-delay: 0s;
    }

    .icon-2 {
        animation-delay: 1.5s;
    }

    .icon-3 {
        animation-delay: 2.5s;
    }

    .cursor-blink {
        animation: blink 0.7s infinite;
    }

    @keyframes blink {

        0%,
        100% {
            opacity: 1;
        }

        50% {
            opacity: 0;
        }
    }
</style>

<script>
    // Course data (kept exactly as original)
    const courseData = {
        'IT': {
            'UG': ['BCA – Bachelor of Computer Applications', 'B.Sc Computer Science', 'B.Sc Information Technology', 'B.Tech Computer Science Engineering', 'B.Tech Information Technology', 'B.Tech AI & ML', 'B.Tech Data Science', 'B.Tech Cyber Security', 'B.Tech Cloud Computing', 'B.Tech Software Engineering', 'B.Tech IoT', 'B.Tech Computer Engineering', 'B.Tech Blockchain Technology'],
            'PG': ['MCA – Master of Computer Applications', 'M.Sc Computer Science', 'M.Sc Information Technology', 'M.Tech Computer Science', 'M.Tech Information Technology', 'M.Tech AI / ML', 'M.Tech Data Science', 'M.Tech Cyber Security'],
            'Diploma': ['Diploma in Computer Engineering', 'Diploma in Information Technology', 'Diploma in Software Engineering', 'Full Stack Development', 'Data Science', 'AI / ML', 'Cyber Security', 'Cloud Computing']
        },
        'Engineering': {
            'UG': ['B.Tech Mechanical Engineering', 'B.Tech Civil Engineering', 'B.Tech Electrical Engineering', 'B.Tech Electronics & Communication (ECE)', 'B.Tech Electronics & Instrumentation', 'B.Tech Automobile Engineering', 'B.Tech Chemical Engineering', 'B.Tech Aerospace Engineering', 'B.Tech Biomedical Engineering'],
            'PG': ['M.Tech Mechanical Engineering', 'M.Tech Civil Engineering', 'M.Tech Electrical Engineering', 'M.Tech Electronics Engineering', 'M.Tech Structural Engineering', 'M.Tech Thermal Engineering']
        },
        'Science': {
            'UG': ['B.Sc Mathematics', 'B.Sc Physics', 'B.Sc Chemistry', 'B.Sc Biotechnology', 'B.Sc Microbiology', 'B.Sc Environmental Science'],
            'PG': ['M.Sc Mathematics', 'M.Sc Physics', 'M.Sc Chemistry', 'M.Sc Biotechnology', 'M.Sc Microbiology']
        },
        'Commerce': {
            'UG': ['B.Com', 'BBA – Bachelor of Business Administration', 'BMS – Business Management Studies'],
            'PG': ['M.Com', 'MBA – Master of Business Administration', 'PGDM']
        },
        'Arts': {
            'UG': ['BA (History)', 'BA (Political Science)', 'BA (English)', 'BA (Economics)', 'BA (Sociology)', 'BJMC – Journalism & Mass Communication', 'BFA – Fine Arts'],
            'PG': ['MA (English)', 'MA (History)', 'MA (Political Science)', 'MA (Economics)', 'MA (Sociology)', 'MJMC – Journalism']
        },
        'Medical': {
            'UG': ['MBBS', 'BDS', 'B.Pharm', 'B.Sc Nursing', 'BPT – Physiotherapy', 'BAMS', 'BHMS'],
            'PG': ['MD', 'MS', 'M.Pharm', 'M.Sc Nursing']
        },
        'Law': {
            'UG': ['LLB', 'BA LLB', 'B.Ed', 'Hotel Management (BHM)', 'Fashion Designing', 'Interior Designing'],
            'PG': ['M.Ed', 'D.El.Ed', 'Hotel Management (MHM)']
        }
    };

    function updateFormFields() {
        const roleSelector = document.querySelector('input[name="role"]:checked');
        if (!roleSelector) return;

        const role = roleSelector.value;

        ['student', 'alumni', 'faculty'].forEach(r => {
            const field = document.getElementById(r + 'Fields');
            if (field) {
                if (role === r) {
                    field.style.display = 'block';
                    // Trigger reveal animation slightly after display
                    setTimeout(() => field.classList.add('revealed'), 50);
                } else {
                    field.style.display = 'none';
                    field.classList.remove('revealed');
                }
            }
        });

        // Trigger progress calculation update on role change
        setTimeout(calculateProgress, 100);
    }

    function updateCourseDropdown() {
        const category = document.getElementById('category').value;
        const level = document.getElementById('level').value;
        const degreeSelect = document.getElementById('degree');

        degreeSelect.innerHTML = '<option value="">Select Course</option>';

        if (category && level && courseData[category] && courseData[category][level]) {
            courseData[category][level].forEach(course => {
                const option = document.createElement('option');
                option.value = course;
                option.textContent = course;
                degreeSelect.appendChild(option);
            });
        }
        calculateProgress();
    }

    function updateAlumniCourseDropdown() {
        const category = document.getElementById('alum_category').value;
        const level = document.getElementById('alum_level').value;
        const degreeSelect = document.getElementById('alum_degree');

        degreeSelect.innerHTML = '<option value="">Select Course</option>';

        if (category && level && courseData[category] && courseData[category][level]) {
            courseData[category][level].forEach(course => {
                const option = document.createElement('option');
                option.value = course;
                option.textContent = course;
                degreeSelect.appendChild(option);
            });
        }
        calculateProgress();
    }

    // Progress Bar Calculation
    function calculateProgress() {
        let totalFields = 0;
        let filledFields = 0;

        // Common fields
        const commonInputs = document.querySelectorAll('#name, #email, #phone, #password');
        totalFields += commonInputs.length;
        commonInputs.forEach(input => {
            if (input.value.trim() !== '') filledFields++;
        });

        // Role specific fields
        const roleSelector = document.querySelector('input[name="role"]:checked');
        if (roleSelector) {
            const role = roleSelector.value;
            const roleContainer = document.getElementById(role + 'Fields');
            if (roleContainer) {
                const roleInputs = roleContainer.querySelectorAll('input, select');
                roleInputs.forEach(input => {
                    totalFields++;
                    if (input.value.trim() !== '') filledFields++;
                });
            }
        }

        const percentage = totalFields === 0 ? 0 : Math.round((filledFields / totalFields) * 100);
        const progressBar = document.getElementById('form-progress');
        const badge = document.getElementById('completion-badge');

        if (progressBar) progressBar.style.width = `${percentage}%`;
        if (badge) badge.textContent = `${percentage}% Complete`;

        // Color change based on progress
        if (percentage < 50) {
            if (progressBar) progressBar.style.background = 'linear-gradient(90deg, #ef4444, #f59e0b)';
        } else {
            if (progressBar) progressBar.style.background = 'linear-gradient(90deg, #6366f1, #10b981)';
        }
    }

    // Typing Effect
    const textArray = ["Join Us", "Join the Future", "Join the Community", "Connect Now"];
    let textIndex = 0;
    let charIndex = 0;
    let isDeleting = false;

    function typeEffect() {
        const currentText = textArray[textIndex];
        const typingElement = document.getElementById('typing-text');

        if (isDeleting) {
            typingElement.textContent = currentText.substring(0, charIndex - 1);
            charIndex--;
        } else {
            typingElement.textContent = currentText.substring(0, charIndex + 1);
            charIndex++;
        }

        let typeSpeed = isDeleting ? 100 : 200;

        if (!isDeleting && charIndex === currentText.length) {
            isDeleting = true;
            typeSpeed = 2000; // Pause at end
        } else if (isDeleting && charIndex === 0) {
            isDeleting = false;
            textIndex = (textIndex + 1) % textArray.length;
            typeSpeed = 500;
        }

        setTimeout(typeEffect, typeSpeed);
    }


    document.addEventListener('DOMContentLoaded', () => {
        // Start Typing Effect
        typeEffect();

        // Trigger Initial Reveals
        setTimeout(() => {
            document.querySelectorAll('.reveal-fade').forEach(el => {
                // Only reveal if not hidden by role logic (except initial ones)
                if (el.offsetParent !== null) {
                    el.classList.add('revealed');
                }
            });
        }, 100);

        // Initial form field setup
        updateFormFields();

        // Magnetic Button Logic
        const magneticBtns = document.querySelectorAll('.magnetic-button');
        magneticBtns.forEach(btn => {
            btn.addEventListener('mousemove', (e) => {
                const { left, top, width, height } = btn.getBoundingClientRect();
                const x = (e.clientX - left - width / 2) * 0.3;
                const y = (e.clientY - top - height / 2) * 0.3;
                const glow = btn.querySelector('.btn-glow');

                btn.style.transform = `translate(${x}px, ${y}px)`;
                if (glow) {
                    glow.style.left = `${e.clientX - left}px`;
                    glow.style.top = `${e.clientY - top}px`;
                }
            });
            btn.addEventListener('mouseleave', () => {
                btn.style.transform = 'translate(0, 0)';
            });
        });

        // 3D Parallax Tilt & Glow for Register Card
        const registerCard = document.querySelector('.card-modern');
        if (registerCard) {
            registerCard.addEventListener('mousemove', (e) => {
                const rect = registerCard.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                const centerX = rect.width / 2;
                const centerY = rect.height / 2;

                // Subtle tilt
                const rotateX = (y - centerY) / 50;
                const rotateY = (centerX - x) / 50;

                registerCard.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
            });

            registerCard.addEventListener('mouseleave', () => {
                registerCard.style.transform = 'perspective(1000px) rotateX(0) rotateY(0)';
            });
        }

        // --- Floating Label Fix for Overlap (Always-Up Persistence) ---
        const formInputs = document.querySelectorAll('.form-control-modern, .form-select');

        function updateLabel(input) {
            if (input.value && input.value.trim() !== '') {
                input.classList.add('has-content');
            } else {
                input.classList.remove('has-content');
            }
            calculateProgress(); // Also update progress on input change
        }

        formInputs.forEach(input => {
            updateLabel(input);

            input.addEventListener('input', () => updateLabel(input));
            input.addEventListener('change', () => updateLabel(input));
            input.addEventListener('blur', () => updateLabel(input));

            input.addEventListener('animationstart', (e) => {
                if (e.animationName === 'onAutoFillStart') {
                    input.classList.add('has-content');
                    calculateProgress();
                }
            });
        });

        setTimeout(() => {
            formInputs.forEach(updateLabel);
            updateFormFields(); // Initialize form visibility
        }, 100);
    });

    // Form Validation Function
    function validateRegisterForm() {
        const role = document.querySelector('input[name="role"]:checked')?.value;
        const name = document.getElementById('name');
        const email = document.getElementById('email');
        const phone = document.getElementById('phone');
        const password = document.getElementById('password');
        const confirmPassword = document.getElementById('confirm_password');
        const terms = document.getElementById('terms');

        function showError(element, message) {
            alert(message);
            element.focus();
            element.classList.add('is-invalid');
            return false;
        }

        // Check common fields
        if (!role) {
            alert('Please select a role');
            return false;
        }

        if (!name.value.trim()) return showError(name, 'Full Name details are incomplete!');
        if (!email.value.trim()) return showError(email, 'Email Address details are incomplete!');
        if (!phone.value.trim()) return showError(phone, 'Phone Number details are incomplete!');
        if (!password.value) return showError(password, 'Password details are incomplete!');
        if (!confirmPassword.value) return showError(confirmPassword, 'Confirm Password details are incomplete!');

        if (password.value !== confirmPassword.value) {
            return showError(confirmPassword, 'Passwords do not match!');
        }

        if (!terms.checked) {
            alert('You must agree to the Terms & Conditions');
            terms.focus();
            return false;
        }

        // Check role-specific required fields
        if (role === 'student') {
            const enrollment_no = document.getElementById('enrollment_no');
            const category = document.getElementById('category');
            const level = document.getElementById('level');
            const degree = document.getElementById('degree');
            const department = document.getElementById('department');

            if (!enrollment_no.value.trim()) return showError(enrollment_no, 'Enrollment No details are incomplete!');
            if (!category.value) return showError(category, 'Category details are incomplete!');
            if (!level.value) return showError(level, 'Level details are incomplete!');
            if (!degree.value) return showError(degree, 'Course/Degree details are incomplete!');
            if (!department.value) return showError(department, 'Department details are incomplete!');
        }
        else if (role === 'alumni') {
            const enrollment_no = document.getElementById('alum_enrollment_no');
            const category = document.getElementById('alum_category');
            const level = document.getElementById('alum_level');
            const degree = document.getElementById('alum_degree');
            const department = document.getElementById('alum_department');
            const pass_year = document.getElementById('pass_year');

            if (!enrollment_no.value.trim()) return showError(enrollment_no, 'Enrollment No details are incomplete!');
            if (!category.value) return showError(category, 'Category details are incomplete!');
            if (!level.value) return showError(level, 'Level details are incomplete!');
            if (!degree.value) return showError(degree, 'Course/Degree details are incomplete!');
            if (!department.value) return showError(department, 'Department details are incomplete!');
            if (!pass_year.value) return showError(pass_year, 'Passing Year details are incomplete!');
        }
        else if (role === 'faculty') {
            const employee_id = document.getElementById('fac_employee_id');
            const department = document.getElementById('fac_department');
            const designation = document.getElementById('fac_designation');

            if (!employee_id.value.trim()) return showError(employee_id, 'Employee ID details are incomplete!');
            if (!department.value) return showError(department, 'Department details are incomplete!');
            if (!designation.value) return showError(designation, 'Designation details are incomplete!');
        }

        // Strict Gmail Validation
        const gmailRegex = /^[a-zA-Z0-9._%+-]+@gmail\.com$/;
        if (!gmailRegex.test(email.value.trim())) {
            return showError(email, 'Please enter a valid Gmail address (ending in @gmail.com)');
        }

        // Password Strength Validation
        if (password.value.length < 8) {
            return showError(password, 'Password must be at least 8 characters long!');
        }

        // Show Loading State
        const submitBtn = document.querySelector('button[type="submit"]');
        if (submitBtn) {
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Sending OTP...';
            submitBtn.disabled = true;
        }

        return true;
    }

    // Real-time Password Match visual
    document.getElementById('confirm_password').addEventListener('input', function () {
        const password = document.getElementById('password').value;
        if (this.value === password && this.value !== '') {
            this.classList.remove('is-invalid');
            this.classList.add('is-valid');
        } else {
            this.classList.remove('is-valid');
            this.classList.add('is-invalid');
        }
    });

    // Remove is-invalid on input
    document.querySelectorAll('.form-control, .form-select').forEach(input => {
        input.addEventListener('input', function () {
            if (this.value.trim() !== '') {
                this.classList.remove('is-invalid');
            }
        });
    });


    // Add CSS for 3D logic dynamically
    const style = document.createElement('style');
    style.textContent = `
    .card-modern {
        transform-style: preserve-3d;
        will-change: transform;
        transition: transform 0.1s ease-out;
    }
`;
    document.head.appendChild(style);
</script>

<script>
    // --- Advanced Branding Animations ---

    document.addEventListener('DOMContentLoaded', () => {

        // 1. Typing Text Animation
        const typingElement = document.getElementById('typing-text');
        const phrases = ["Global Network", "Thriving Community", "Lifelong Connections", "Successful Career"];

        // Initial State: Start fully typed to match HTML ("Global Network")
        let phraseIndex = 0;
        let charIndex = phrases[0].length;
        let isDeleting = true; // Next action is deleting, but we wait first

        function type() {
            const currentPhrase = phrases[phraseIndex];
            let typeSpeed = 100;

            if (isDeleting) {
                typingElement.textContent = currentPhrase.substring(0, charIndex - 1);
                charIndex--;
                typeSpeed = 175; // Deletion speed
            } else {
                typingElement.textContent = currentPhrase.substring(0, charIndex + 1);
                charIndex++;
                typeSpeed = 150; // Typing speed
            }

            if (!isDeleting && charIndex === currentPhrase.length) {
                // Typed full phrase -> Wait 4s
                isDeleting = true;
                typeSpeed = 4000;
            } else if (isDeleting && charIndex === 0) {
                // Deleted full phrase -> Wait 0.5s then start typing next
                isDeleting = false;
                phraseIndex = (phraseIndex + 1) % phrases.length;
                typeSpeed = 500;
            }

            setTimeout(type, typeSpeed);
        }

        // Start logic: Wait 4s before the first delete action
        if (typingElement) setTimeout(type, 4500);


        // 2. Animated Number Counters
        const counters = document.querySelectorAll('.counter');
        const speed = 200; // The lower the slower

        const animateCounters = () => {
            counters.forEach(counter => {
                const updateCount = () => {
                    const target = +counter.getAttribute('data-target');
                    const count = +counter.innerText;
                    const inc = target / speed;

                    if (count < target) {
                        counter.innerText = Math.ceil(count + inc);
                        setTimeout(updateCount, 20);
                    } else {
                        counter.innerText = target.toLocaleString(); // Format with commas
                    }
                };
                updateCount();
            });
        };

        // Trigger counters when in view
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    animateCounters();
                    observer.unobserve(entry.target); // Run once
                }
            });
        });

        if (document.querySelector('.mt-5')) {
            observer.observe(document.querySelector('.mt-5')); // Observe the footer stats section
        }


        // 3. 3D Tilt Effect (Vanilla JS)
        const cards = document.querySelectorAll('[data-tilt]');

        cards.forEach(card => {
            card.addEventListener('mousemove', (e) => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                const centerX = rect.width / 2;
                const centerY = rect.height / 2;

                const rotateX = ((y - centerY) / centerY) * -10; // Max tilt 10deg
                const rotateY = ((x - centerX) / centerX) * 10;

                card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
            });

            card.addEventListener('mouseleave', () => {
                card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale(1)';
            });
        });


        // 4. Mouse Parallax for Blobs (Optimized)
        let ticking = false;
        document.addEventListener('mousemove', (e) => {
            if (!ticking) {
                window.requestAnimationFrame(() => {
                    const blobs = document.querySelectorAll('.blob-1, .blob-2');
                    const x = (window.innerWidth - e.pageX * 2) / 100;
                    const y = (window.innerHeight - e.pageY * 2) / 100;

                    blobs.forEach((blob, index) => {
                        const speed = index === 0 ? 2 : -2; // Opposite directions
                        blob.style.transform = `translateX(${x * speed}px) translateY(${y * speed}px)`;
                    });
                    ticking = false;
                });
                ticking = true;
            }
        });

    });
</script>

<style>
    /* New Branding Section Styles & Animations */

    /* Blob Animations */
    .blob-1 {
        animation: float 10s infinite ease-in-out;
    }

    .blob-2 {
        animation: float 12s infinite ease-in-out reverse;
    }

    @keyframes float {

        0%,
        100% {
            transform: translate(0px, 0px) scale(1);
        }

        33% {
            transform: translate(30px, -50px) scale(1.1);
        }

        66% {
            transform: translate(-20px, 20px) scale(0.9);
        }
    }

    /* Glass Card Enhancements */
    .glass-card {
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .glass-card:hover {
        transform: translateY(-8px) scale(1.02);
        background: rgba(255, 255, 255, 0.85) !important;
        /* Brighter on hover */
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        border-color: rgba(16, 185, 129, 0.3);
        /* Subtle green border on hover */
    }

    /* Carousel Entry Animations */
    /* Only animate when the slide is ACTIVE */
    .carousel-item.active .glass-card {
        animation: fadeInUp 0.8s ease-out forwards;
    }

    .carousel-item.active .glass-card i {
        animation: zoomIn 0.6s ease-out 0.2s forwards;
        opacity: 0;
    }

    .carousel-item.active .glass-card h5 {
        animation: fadeInUp 0.6s ease-out 0.3s forwards;
        opacity: 0;
    }

    .carousel-item.active .glass-card p {
        animation: fadeInUp 0.6s ease-out 0.4s forwards;
        opacity: 0;
    }

    /* Keyframes */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes zoomIn {
        from {
            opacity: 0;
            transform: scale(0.5);
        }

        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    /* Text Graident */
    .text-gradient-primary {
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-size: 200% auto;
        animation: gradientFlow 5s ease infinite;
    }

    @keyframes gradientFlow {
        0% {
            background-position: 0% 50%;
        }

        50% {
            background-position: 100% 50%;
        }

        100% {
            background-position: 0% 50%;
        }
    }

    /* Carousel Indicators */
    .carousel-indicators button {
        opacity: 0.5;
        transition: all 0.3s ease;
        width: 10px !important;
        height: 10px !important;
        margin: 0 6px !important;
        border: 2px solid transparent;
        /* Expand feeling */
    }

    .carousel-indicators button.active {
        opacity: 1;
        transform: scale(1.3);
        background-color: #10b981 !important;
        /* Green active state */
        box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
    }

    /* Interactive Branding Logo Area */
    .rounded-circle.bg-primary {
        transition: transform 0.5s ease;
    }

    .rounded-circle.bg-primary:hover {
        transform: rotate(360deg);
        /* Playful Spin */
    }

    /* Cursor Blink */
    .cursor-blink {
        animation: blink 1s infinite;
        font-weight: 100;
        margin-left: 2px;
        color: #0ea5e9;
    }

    @keyframes blink {

        0%,
        100% {
            opacity: 1;
        }

        50% {
            opacity: 0;
        }
    }

    /* Smooth Parallax Transition */
    .blob-1,
    .blob-2 {
        transition: transform 0.1s ease-out;
    }
</style>
{% endblock %}