<!-- filepath: d:\RajenderMohan_BCA\RajenderMohan_Projects\6_Semester\Major Project\Alumni App\templates\edit_alumni_profile.html -->
{% extends "base.html" %}

{% block content %}
<div class="container mt-5 mb-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg border-0" style="border-radius: 15px; animation: slideInUp 0.6s ease;">
                <div class="card-header bg-success text-white" style="border-radius: 15px 15px 0 0;">
                    <h3 class="mb-0"><i class="fas fa-edit"></i> Edit Alumni Profile</h3>
                    <small>Update your professional and personal information</small>
                </div>
                <div class="card-body p-5">
                    <form id="editForm" method="POST" enctype="multipart/form-data" class="needs-validation">
                        <!-- Profile Photo -->
                        <div class="card mb-4 border-light">
                            <div class="card-header bg-light border-0">
                                <h6 class="mb-0"><i class="fas fa-image"></i> Profile Photo</h6>
                            </div>
                            <div class="card-body text-center">
                                <div class="mb-3">
                                    <img id="photoPreview" 
                                         src="https://ui-avatars.com/api/?name={{ user['name'] }}&size=150&background=28A745&color=fff&rounded=true" 
                                         alt="Profile Photo" class="rounded-circle" style="width: 150px; height: 150px; object-fit: cover;">
                                </div>
                                <div class="mb-3">
                                    <label for="profile_pic" class="form-label">Upload Photo (JPG, PNG, GIF - Max 16MB)</label>
                                    <input type="file" class="form-control" id="profile_pic" name="profile_pic" 
                                           accept="image/*" onchange="previewPhoto(this)">
                                </div>
                            </div>
                        </div>

                        <!-- Personal Information -->
                        <div class="card mb-4 border-light">
                            <div class="card-header bg-light border-0">
                                <h6 class="mb-0"><i class="fas fa-user-circle"></i> Personal Information</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="name" class="form-label">Full Name <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="name" name="name" 
                                               value="{{ user['name'] }}" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="phone" class="form-label">Phone <span class="text-danger">*</span></label>
                                        <input type="tel" class="form-control" id="phone" name="phone" 
                                               value="{{ user['phone'] or '' }}" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Professional Information -->
                        <div class="card mb-4 border-light">
                            <div class="card-header bg-light border-0">
                                <h6 class="mb-0"><i class="fas fa-briefcase"></i> Professional Information</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="company_name" class="form-label">Company Name</label>
                                        <input type="text" class="form-control" id="company_name" name="company_name" 
                                               value="{{ profile['company_name'] or '' }}" placeholder="e.g., Google, Microsoft">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="designation" class="form-label">Designation</label>
                                        <input type="text" class="form-control" id="designation" name="designation" 
                                               value="{{ profile['designation'] or '' }}" placeholder="e.g., Senior Engineer">
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="work_location" class="form-label">Work Location</label>
                                        <input type="text" class="form-control" id="work_location" name="work_location" 
                                               value="{{ profile['work_location'] or '' }}" placeholder="e.g., Bangalore, India">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="experience_years" class="form-label">Experience (Years)</label>
                                        <input type="number" class="form-control" id="experience_years" name="experience_years" 
                                               value="{{ profile['experience_years'] or '' }}" min="0" placeholder="e.g., 5">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Online Presence -->
                        <div class="card mb-4 border-light">
                            <div class="card-header bg-light border-0">
                                <h6 class="mb-0"><i class="fas fa-link"></i> Online Presence</h6>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="linkedin_url" class="form-label">LinkedIn Profile URL</label>
                                    <input type="url" class="form-control" id="linkedin_url" name="linkedin_url" 
                                           value="{{ profile['linkedin_url'] or '' }}" 
                                           placeholder="https://linkedin.com/in/yourprofile">
                                </div>
                            </div>
                        </div>

                        <!-- Bio & Achievements -->
                        <div class="card mb-4 border-light">
                            <div class="card-header bg-light border-0">
                                <h6 class="mb-0"><i class="fas fa-star"></i> Bio & Achievements</h6>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="bio" class="form-label">Bio / About You</label>
                                    <textarea class="form-control" id="bio" name="bio" rows="3" 
                                              placeholder="Tell us about your professional journey...">{{ profile['bio'] or '' }}</textarea>
                                </div>

                                <div class="mb-3">
                                    <label for="achievements" class="form-label">Achievements 
                                        <small class="text-muted">(use | to separate)</small>
                                    </label>
                                    <textarea class="form-control" id="achievements" name="achievements" rows="3" 
                                              placeholder="e.g., Led 5+ projects | Promoted to Senior role | Won Innovation Award">{{ profile['achievements'] or '' }}</textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-success btn-lg fw-bold">
                                <i class="fas fa-save"></i> Save Changes
                            </button>
                            <a href="{{ url_for('alumni_profile', user_id=user['id']) }}" class="btn btn-outline-secondary">
                                Cancel & Go Back
                            </a>
                            <a href="{{ url_for('change_password') }}" class="btn btn-outline-info">
                                <i class="fas fa-lock"></i> Change Password
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .card {
        border-radius: 10px;
        transition: all 0.3s ease;
        border: none !important;
    }

    .card-header {
        border-radius: 10px 10px 0 0 !important;
    }

    @keyframes slideInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }

    #photoPreview {
        transition: all 0.3s ease;
        border: 3px solid #28A745;
        animation: pulse 2s infinite;
    }

    #photoPreview:hover {
        box-shadow: 0 0 20px rgba(40, 167, 69, 0.5);
    }
</style>

<script>
function previewPhoto(input) {
    if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('photoPreview').src = e.target.result;
        };
        reader.readAsDataURL(input.files[0]);
    }
}

// Toast notification function
function showToast(message, type = 'warning') {
    const toastHtml = `
        <div class="toast align-items-center text-white bg-${type} border-0" role="alert" aria-live="assertive" aria-atomic="true" style="position: fixed; top: 20px; right: 20px; z-index: 9999; min-width: 300px;">
            <div class="d-flex">
                <div class="toast-body">
                    <i class="fas fa-${type === 'warning' ? 'exclamation-circle' : 'check-circle'} me-2"></i>${message}
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
        </div>
    `;
    const toastContainer = document.createElement('div');
    toastContainer.innerHTML = toastHtml;
    document.body.appendChild(toastContainer);
    
    const toastElement = toastContainer.querySelector('.toast');
    const toast = new bootstrap.Toast(toastElement);
    toast.show();
    
    setTimeout(() => toastContainer.remove(), 5000);
}

// Form submission with validation
document.getElementById('editForm').addEventListener('submit', function(e) {
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    
    if (!name) {
        e.preventDefault();
        showToast('Name is required!', 'warning');
        return false;
    }
    
    if (!phone) {
        e.preventDefault();
        showToast('Phone is required!', 'warning');
        return false;
    }
    
    // If validation passes, form submits normally
    return true;
});
</script>
{% endblock %}